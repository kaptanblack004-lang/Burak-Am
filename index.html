<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>BURAK AM FLAPPY VERSÄ°ONðŸ˜†</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background: #000; touch-action: none; font-family: 'Arial Black', sans-serif; }
        canvas { display: block; margin: 0 auto; background: #000; }
        
        #ui {
            position: fixed; top: 0; left: 50%; transform: translateX(-50%);
            width: 100%; max-width: 440px; height: 100%;
            pointer-events: none; z-index: 100;
        }
        .score-text {
            text-align: center; color: #fff; font-size: 70px;
            text-shadow: 0 0 20px #0ff; margin-top: 20px;
        }
        #game-over-box {
            display: none; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); pointer-events: auto;
            background: rgba(10, 10, 10, 0.95); border: 4px solid #f0f;
            padding: 25px; border-radius: 20px; text-align: center; width: 80%;
            box-shadow: 0 0 50px #f0f;
        }
        #game-over-box img { width: 100%; border-radius: 10px; margin: 15px 0; }
        
        /* Ã‡ALIÅžAN BUTON STÄ°LÄ° */
        .retry-btn {
            background: linear-gradient(45deg, #f0f, #0ff);
            color: #fff; border: none; padding: 18px 0;
            font-size: 24px; border-radius: 12px; cursor: pointer;
            font-weight: bold; width: 100%; display: block;
            text-shadow: 1px 1px 2px #000;
            box-shadow: 0 4px 15px rgba(255, 0, 255, 0.4);
        }
        .retry-btn:hover { filter: brightness(1.2); }
        .retry-btn:active { transform: scale(0.95); }
    </style>
</head>
<body>

<div id="ui">
    <div class="score-text" id="scoreDisplay">0</div>
    <div id="game-over-box">
        <h2 style="color:#f0f; margin:0;">EYVAH! Ã‡ARPTIN!</h2>
        <img src="https://i.imgur.com/GqDuolU.jpeg" alt="Dead">
        <p style="color:#fff; font-size:20px;">SKORUN: <span id="finalScore">0</span></p>
        <button class="retry-btn" id="megaRetryBtn">TEKRAR DENE</button>
    </div>
</div>

<canvas id="gameCanvas"></canvas>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const scoreDisplay = document.getElementById("scoreDisplay");
const gameOverBox = document.getElementById("game-over-box");
const retryBtn = document.getElementById("megaRetryBtn");

let w = window.innerWidth > 440 ? 440 : window.innerWidth;
let h = window.innerHeight;
canvas.width = w; canvas.height = h;

const bImg = new Image(); bImg.src = "https://i.imgur.com/9sZhySO.jpeg";

// Oyun DurumlarÄ±
let isRunning = true;
let score = 0, frame = 0, speed = 3.5;
let bird = { x: 60, y: h/2, w: 45, h: 45, v: 0, g: 0.35, j: -7 };
let pipes = [];

function resetGame() {
    // TÃ¼m deÄŸerleri fabrika ayarlarÄ±na dÃ¶ndÃ¼r
    score = 0; frame = 0; speed = 3.5;
    bird = { x: 60, y: h/2, w: 45, h: 45, v: 0, g: 0.35, j: -7 };
    pipes = [];
    scoreDisplay.innerText = "0";
    gameOverBox.style.display = "none";
    isRunning = true;
    
    // DÃ¶ngÃ¼ durmuÅŸsa tekrar baÅŸlatma gerekmez Ã§Ã¼nkÃ¼ requestAnimationFrame devam ediyor
}

function stopGame() {
    isRunning = false;
    document.getElementById("finalScore").innerText = score;
    gameOverBox.style.display = "block";
}

function update() {
    if(!isRunning) return;

    bird.v += bird.g;
    bird.y += bird.v;

    // Boru Ãœretimi
    if(frame % 80 === 0) {
        let gap = 160;
        let top = Math.random() * (h - gap - 150) + 75;
        pipes.push({ x: w, t: top, g: gap, p: false });
    }

    pipes.forEach((p, i) => {
        p.x -= speed;
        
        // Ã‡arpÄ±ÅŸma (Hitbox)
        if(bird.x + 5 < p.x + 60 && bird.x + bird.w - 5 > p.x && 
          (bird.y + 5 < p.t || bird.y + bird.h - 5 > p.t + p.g)) {
            stopGame();
        }
        
        // Skor ArtÄ±ÅŸÄ±
        if(!p.p && p.x < bird.x) {
            score++; p.p = true;
            scoreDisplay.innerText = score;
            speed += 0.05; // Ã‡Ä±lgÄ±n hÄ±zlanma
        }
        if(p.x < -100) pipes.splice(i, 1);
    });

    if(bird.y > h || bird.y < -50) stopGame();
    frame++;
}

function draw() {
    // Arka Plan TemizliÄŸi
    ctx.fillStyle = "#000";
    ctx.fillRect(0, 0, w, h);
    
    // Matrix benzeri akÄ±ÅŸ Ã§izgileri (Dekoratif)
    ctx.fillStyle = "rgba(0, 255, 255, 0.1)";
    for(let i=0; i<10; i++) ctx.fillRect((i*60 + frame)%w, (i*150)%h, 2, 100);

    // Borular (Parlayan Neon)
    pipes.forEach(p => {
        ctx.fillStyle = "#0f0";
        ctx.shadowBlur = 10; ctx.shadowColor = "#0f0";
        ctx.fillRect(p.x, 0, 60, p.t);
        ctx.fillRect(p.x, p.t + p.g, 60, h);
        ctx.shadowBlur = 0;
    });

    // KuÅŸ Ã‡izimi
    ctx.save();
    ctx.translate(bird.x + bird.w/2, bird.y + bird.h/2);
    ctx.rotate(bird.v * 0.08);
    ctx.drawImage(bImg, -bird.w/2, -bird.h/2, bird.w, bird.h);
    ctx.restore();

    update();
    requestAnimationFrame(draw);
}

// KONTROL MERKEZÄ°
const handleInput = (e) => {
    // EÄŸer Game Over kutusu aÃ§Ä±ksa, ekrana tÄ±klamak kuÅŸu zÄ±platmasÄ±n
    if(!isRunning) return; 
    
    if(e.type === 'touchstart') e.preventDefault();
    bird.v = bird.j;
};

// TEKRAR DENE BUTONU (KESÄ°N Ã‡Ã–ZÃœM)
retryBtn.addEventListener("click", (e) => {
    e.stopPropagation(); // TÄ±klamanÄ±n canvas'a sÄ±zmasÄ±nÄ± engeller
    resetGame();
});

// Mobil ve MasaÃ¼stÃ¼ Dinleyiciler
window.addEventListener("mousedown", handleInput);
window.addEventListener("touchstart", handleInput, {passive: false});
window.addEventListener("keydown", (e) => { if(e.code === "Space") handleInput(e); });

bImg.onload = () => draw();
</script>
</body>
</html>
